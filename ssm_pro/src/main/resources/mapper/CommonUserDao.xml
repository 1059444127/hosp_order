<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.sfturing.dao.CommonUserDao">
	<!-- 查找用户，通过id、email、userName、phone -->
	<select id="findCommonUserByUserId" resultType="CommonUser"
		parameterType="int">
		SELECT * FROM commonuser WHERE user_id = #{userId}
	</select>
	<select id="findCommonUserByUserIdenf" resultType="CommonUser"
		parameterType="java.lang.String">
		SELECT * FROM commonuser WHERE user_idenf = #{userIdenf}
	</select>
	<select id="findCommonUserByUserName" resultType="CommonUser"
		parameterType="java.lang.String">
		SELECT * FROM commonuser WHERE user_name = #{userName}
	</select>
	<select id="findCommonUserByMobile" resultType="CommonUser"
		parameterType="java.lang.String">
		SELECT * FROM commonuser WHERE user_mobile = #{userMobile}
	</select>
	<select id="findCommonUserByEmail" resultType="CommonUser"
		parameterType="java.lang.String">
		SELECT * FROM commonuser WHERE user_email = #{userEmail}
	</select>
	<!-- 插入用户 -->
	<insert id="insertCommonUser">
		INSERT INTO commonuser
		(user_idenf,user_name,user_password,user_sex,user_mobile,user_email,reg_ip)
		VALUE
		(#{userIdenf},#{userName},#{userPassword},#{userSex},#{userMobile},#{userEmail},#{regIp})
	</insert>

	<!-- 删除用户(假删除) -->
	<update id="deleteCommonUser">
		UPDATE FROM commonuser SET
		isDelete=1
		WHERE id = #{id}
	</update>
	<update id="deleteCommonUserByIdenf">
		UPDATE FROM commonuser SET
		isDelete=1
		WHERE user_idenf =
		#{userIdenf}
	</update>

	<!-- 更新用户 更改密码、更改邮箱、更改手机（用户个人中心修改） -->
	<update id="modifyPassWord">
		UPDATE commonuser SET
		passWord=#{newPassWord}
		WHERE user_idenf=#{user_idenf}
	</update>
	<update id="modifyEmail">
		UPDATE commonuser SET
		email=#{newEmail}
		WHERE
		user_idenf=#{user_idenf}
	</update>
	<update id="modifyPhone">
		UPDATE commonuser SET
		phone=#{newPhone}
		WHERE
		user_idenf=#{user_idenf}
	</update>
	<!-- 激活用户 -->
	<update id="activateUser">
		UPDATE commonuser SET
		status=1
		WHERE user_email=#{userEmail}
	</update>
	
	<!-- 更新用户信息 -->
	<update id="modifyIpAndTime">
		UPDATE commonuser SET
		last_login_time =#{lastLoginTime},last_login_ip=#{lastLoginIp}
		WHERE user_email=#{userEmail}	
	</update>



</mapper>